#!/bin/bash -l
set -e

tags="$1"

if [ -z $tags ]; then
  tags="all"
fi

if ! [ -x "$(command -v conda)" ]; then
		bash scripts/miniconda-setup.sh
	fi

if ! [ -x "$(command -v ansible)" ]; then
	conda install -c conda-forge ansible
fi

ansible-galaxy install diodonfrost.p10k
ansible-galaxy install geerlingguy.nodejs
ansible-galaxy install geerlingguy.docker
ansible-playbook -i ~/dotfiles/hosts ~/dotfiles/dotfiles.yml --ask-become-pass --tags $tags

if [ $tags = "nvim" ]; then
	nvim +PackerSync
fi
